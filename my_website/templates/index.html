<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å°ç«™ - æœˆè®°/æ—¥å¿—</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav>
        <div class="container">
            <a href="/">é¦–é¡µ</a>
            <a href="/post">å‘å¸ƒæ—¥å¿—</a>
            <a href="/trash">æƒ…ç»ªåƒåœ¾æ¡¶</a>
            <a href="/admin">åå°ç®¡ç†</a>
            <span style="color: #ff99cc; margin-left: 20px;">æ¬¢è¿ï¼Œ{{ username }}</span>
            <a href="/logout" style="color: #ff6b6b; margin-left: 10px;">é€€å‡º</a>
        </div>
    </nav>

    <!-- å½©è›‹ -->
    {% if egg %}
    <div class="egg container">{{ egg }}</div>
    {% endif %}

    <!-- ä¸»ä½“å†…å®¹ -->
    <div class="container">
        <h1 style="text-align: center; margin: 20px 0; color: #a8d8ff; text-shadow: 0 0 10px #a8d8ff;">æˆ‘çš„æœˆè®°/æ—¥å¿—</h1>
        
        <!-- ä¹¦æ¶å®¹å™¨ -->
        <div class="bookshelf">
            <h2 style="color: #fff; margin-bottom: 20px; text-align: center;">æˆ‘çš„æ—¥å¿—ä¹¦æ¶ ğŸ“š</h2>
            {% if posts %}
                {% for post in posts %}
                <div class="book-card">
                    <h2>{{ post.title }}</h2>
                    <div class="meta">
                        æ ‡ç­¾ï¼š{{ post.tag }} | {{ post.time }}
                    </div>
                    <div class="content-preview">{{ post.content[:80] }}...</div>
                    <a href="#post-{{ post.id }}" class="read-more">å±•å¼€é˜…è¯»</a>
                </div>

                <!-- å±•å¼€çš„æ—¥å¿—è¯¦æƒ…ï¼ˆé»˜è®¤éšè—ï¼Œç‚¹å‡»æ˜¾ç¤ºï¼‰ -->
                <div id="post-{{ post.id }}" class="card" style="display: none; margin-top: 20px;">
                    <h2>{{ post.title }}</h2>
                    <div class="meta">
                        æ ‡ç­¾ï¼š{{ post.tag }} | å‘å¸ƒæ—¶é—´ï¼š{{ post.time }}
                    </div>
                    <p>{{ post.content }}</p>
                    
                    {% if post.img_url %}
                    <img src="{{ post.img_url }}" class="post-img" alt="æ—¥å¿—å›¾ç‰‡">
                    {% endif %}
                    
                    {% if post.video_url %}
                    <div class="form-group">
                        <a href="{{ post.video_url }}" target="_blank" style="color: #ff99cc;">æŸ¥çœ‹è§†é¢‘</a>
                        <a href="{{ post.video_url }}" download style="color: #ff99cc; margin-left: 10px;">ä¸‹è½½è§†é¢‘</a>
                    </div>
                    {% endif %}

                    <!-- ç•™è¨€åŒº -->
                    <div class="comments">
                        <h3>ç•™è¨€</h3>
                        {% for comment in post.comments %}
                        <div class="comment-item">
                            <span class="name">{{ comment.name }}</span>
                            <span class="time">{{ comment.time }}</span>
                            <p>{{ comment.content }}</p>
                        </div>
                        {% endfor %}

                        <form action="/add_comment/{{ post.id }}" method="POST">
                            <div class="form-group">
                                <label>ä½ çš„åå­—</label>
                                <input type="text" name="name" required>
                            </div>
                            <div class="form-group">
                                <label>ç•™è¨€å†…å®¹</label>
                                <textarea name="comment" required></textarea>
                            </div>
                            <button type="submit">æäº¤ç•™è¨€</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p style="color: #fff; text-align: center; font-size: 16px;">ä¹¦æ¶ç©ºç©ºå¦‚ä¹Ÿï¼Œå¿«å»å‘å¸ƒç¬¬ä¸€ç¯‡æ—¥å¿—å§ï½</p>
            {% endif %}
        </div>
    </div>

    <!-- ç‚¹å‡»å±•å¼€æ—¥å¿—çš„JS -->
    <script>
        // ç»™æ‰€æœ‰â€œå±•å¼€é˜…è¯»â€ç»‘å®šç‚¹å‡»äº‹ä»¶
        document.querySelectorAll('.read-more').forEach(link => {
            link.onclick = function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').slice(1);
                // éšè—æ‰€æœ‰å±•å¼€çš„æ—¥å¿—
                document.querySelectorAll('.card[id^="post-"]').forEach(card => {
                    card.style.display = 'none';
                });
                // æ˜¾ç¤ºå½“å‰ç‚¹å‡»çš„æ—¥å¿—
                document.getElementById(targetId).style.display = 'block';
                // æ»šåŠ¨åˆ°æ—¥å¿—ä½ç½®
                document.getElementById(targetId).scrollIntoView({ behavior: 'smooth' });
            }
        });

        // æ˜Ÿç©ºå½©è›‹ï¼šç‚¹å‡»é¡µé¢ç”Ÿæˆæ˜Ÿæ˜Ÿ
        document.addEventListener('click', (e) => {
            const star = document.createElement('div');
            star.style.position = 'absolute';
            star.style.left = e.clientX + 'px';
            star.style.top = e.clientY + 'px';
            star.style.width = '10px';
            star.style.height = '10px';
            star.style.background = '#fff';
            star.style.borderRadius = '50%';
            star.style.boxShadow = '0 0 10px #fff';
            star.style.pointerEvents = 'none';
            star.style.animation = 'starFade 1s ease-out';
            document.body.appendChild(star);
            setTimeout(() => star.remove(), 1000);
        });

        // æ˜Ÿæ˜Ÿæ¶ˆå¤±åŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes starFade {
                0% { opacity: 1; transform: scale(1); }
                100% { opacity: 0; transform: scale(0); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>